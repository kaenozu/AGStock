#!/bin/bash

# AGStock УхитІЋсѓ╣сѓ»сЃфсЃЌсЃѕ (Linux/Mac)

echo "========================================"
echo "   AGStock сѓисѓ╣сЃєсЃаУхитІЋ (Linux)"
echo "========================================"
echo ""

# С╗«ТЃ│уњ░тбЃсЂ«уб║УфЇ
if [ ! -d ".venv" ]; then
    echo "Рџа№ИЈ С╗«ТЃ│уњ░тбЃсЂїУдІсЂцсЂІсѓісЂЙсЂЏсѓЊсђѓсѓ╗сЃЃсЃѕсѓбсЃЃсЃЌсѓњт«ЪУАїсЂЌсЂЙсЂЎ..."
    if [ -f "scripts/setup.sh" ]; then
        bash scripts/setup.sh
    else
        echo "РЮї setup.sh сЂїУдІсЂцсЂІсѓісЂЙсЂЏсѓЊсђѓТЅІтІЋсЂДсѓ╗сЃЃсЃѕсѓбсЃЃсЃЌсЂЌсЂдсЂЈсЂасЂЋсЂёсђѓ"
        exit 1
    fi
fi

# С╗«ТЃ│уњ░тбЃсЂ«сѓбсѓ»сЃєсѓБсЃЎсЃ╝сЃѕ
source .venv/bin/activate

# сЃАсЃІсЃЦсЃ╝УАеуц║
echo "УхитІЋсЃбсЃ╝сЃЅсѓњжЂИТіъсЂЌсЂдсЂЈсЂасЂЋсЂё:"
echo "1. ­ЪЊі сЃђсЃЃсѓисЃЦсЃюсЃ╝сЃЅУхитІЋ (Web UI)"
echo "2. ­Ъцќ УЄфтІЋтБ▓У▓исЃЄсЃ╝сЃбсЃ│УхитІЋ (сЃљсЃЃсѓ»сѓ░сЃЕсѓдсЃ│сЃЅт«ЪУАї)"
echo "3. ­ЪЏа№ИЈ  сѓисѓ╣сЃєсЃаУе║ТќГ (сЃєсѓ╣сЃѕт«ЪУАї)"
echo "4. ­Ъџф ухѓС║є"
echo ""
read -p "уЋфтЈисѓњтЁЦтіЏ [1-4]: " choice

case $choice in
    1)
        echo "­Ъџђ сЃђсЃЃсѓисЃЦсЃюсЃ╝сЃЅсѓњУхитІЋсЂЌсЂдсЂёсЂЙсЂЎ..."
        echo "сЃќсЃЕсѓдсѓХсЂД http://localhost:8501 сѓњжќІсЂёсЂдсЂЈсЂасЂЋсЂёсђѓ"
        streamlit run app.py
        ;;
    2)
        echo "­Ъџђ УЄфтІЋтБ▓У▓исЃЄсЃ╝сЃбсЃ│сѓњУхитІЋсЂЌсЂдсЂёсЂЙсЂЎ..."
        python scripts/daemon.py
        ;;
    3)
        echo "­ЪДф сЃєсѓ╣сЃѕсѓњт«ЪУАїсЂЌсЂдсЂёсЂЙсЂЎ..."
        pytest tests/test_fully_automated_trader.py tests/test_phase30_full_integration.py
        ;;
    4)
        echo "ухѓС║єсЂЌсЂЙсЂЎсђѓ"
        exit 0
        ;;
    *)
        echo "уёАті╣сЂфжЂИТіъсЂДсЂЎсђѓ"
        exit 1
        ;;
esac
