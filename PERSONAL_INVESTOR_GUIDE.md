# 個人投資家向けAGStock - セットアップガイド

> 🏠 **完全自動運用**で、仕事に専念しながら資産運用できます

---

## 🚀 新機能（個人投資家向け）

このアップデートで以下の機能が追加されました:

### 1. 📱 スマート通知
- **チャート画像付き通知**: シグナル発生時に価格チャートも一緒に送信
- **重要度フィルタリング**: 信頼度70%以上、期待リターン3%以上のみ通知
- **静穏時間設定**: 22:00-07:00は通知OFF（睡眠を妨げない）
- **LINE & Discord対応**: スマホでサッと確認

### 2. 🤖 完全自動運用
- **毎日15:30に自動スキャン**: 市場終了後に自動で取引
- **毎日08:00に市況レポート**: 出勤前に本日の戦略を確認
- **安全策搭載**:
  - 日次損失制限（-5%でストップ）
  - VIX高騰時は取引中止
  - 最大取引数制限（1日10件まで）

### 3. 📊 シンプルダッシュボード
- **一目でわかる資産状況**: 総資産・本日損益・勝率を表示
- **リスクメーター**: 0-100のスコアでリスクを可視化
- **自動アラート**: 大きな損失や集中リスクを警告
- **わかりやすいアドバイス**: 次に何をすべきか提示

---

## 📋 セットアップ手順（5分）

### ステップ1: 通知設定（LINE）

1. LINE Notifyのトークンを取得:
   - https://notify-bot.line.me/ にアクセス
   - 「マイページ」→「トークンを発行する」
   - トークン名: `AGStock`
   - 送信先: `1:1でLINE Notifyから通知を受け取る`
   - トークンをコピー

2. `config.json`を編集:
```json
{
    "notifications": {
        "min_confidence": 0.7,
        "min_expected_return": 0.03,
        "quiet_hours": "22:00-07:00",
        "line": {
            "enabled": true,
            "token": "ここに貼り付け"
        }
    }
}
```

### ステップ2: 自動実行の設定

Windowsタスクスケジューラに登録（管理者として実行）:

```batch
setup_automation.bat
```

これで以下が自動実行されます:
- **毎日15:30**: 市場スキャン・自動取引
- **毎日08:00**: 朝の市況レポート

### ステップ3: 動作確認

1. 手動でテスト実行:
```bash
python morning_brief.py
```

2. LINEにメッセージが届けばOK！

---

## 💡 使い方

### 完全おまかせモード

**何もしなくてOK**です。PCの電源を入れておくだけ。

- 朝8時: 市況レポートが届く → 今日の戦略を確認
- 夕方15:30: 自動取引 → シグナルがあればLINEで通知
- 夜: 結果確認 → ダッシュボードで損益チェック

### ダッシュボードでチェック

1. アプリ起動:
```bash
streamlit run app.py
```

2. ブラウザで「💼 マイポートフォリオ」タブを開く

3. 確認項目:
   - ✅ 総資産・本日損益
   - ✅ リスクスコア
   - ✅ アラート（あれば）
   - ✅ ポジション一覧

### 通知のカスタマイズ

`config.json`で調整可能:

```json
{
    "notifications": {
        "min_confidence": 0.8,  // 信頼度80%以上のみ通知
        "min_expected_return": 0.05,  // 期待リターン5%以上のみ
        "quiet_hours": "22:00-07:00"  // 静穏時間
    }
}
```

---

## ⚙️ 詳細設定

### リスク管理

`config.json`で調整:

```json
{
    "risk_guard": {
        "daily_loss_limit_pct": -5.0,  // 日次損失上限（-5%）
        "max_position_size_pct": 10.0,  // 1銘柄の最大比率（10%）
        "max_vix": 40.0  // VIX上限（40以上で取引停止）
    },
    "safety": {
        "require_manual_approval": false,  // 自動承認
        "max_daily_trades": 10  // 1日の最大取引数
    }
}
```

### 本番運用への移行

ペーパートレードで1ヶ月以上テストしてから:

1. 証券口座の準備（SBI証券・楽天証券など）
2. API連携の設定（IBKR推奨）
3. `config.json`で本番モードに切り替え:
```json
{
    "broker": {
        "default_mode": "live"  // paper → live
    }
}
```

---

## 📊 運用例（想定）

### 初心者Aさん（30代会社員）

- **元金**: 50万円
- **運用方針**: 完全おまかせ
- **設定**:
  - 通知: LINE
  - リスク: 低め（日次損失-3%）
  - 最大取引数: 5件/日

**1ヶ月後**:
- 取引回数: 12回
- 勝率: 58%
- 月次リターン: +2.8%（14,000円）

### 中級者Bさん（40代会社員）

- **元金**: 200万円
- **運用方針**: AIシグナル + 自分の判断
- **設定**:
  - 通知: LINE + Discord
  - リスク: 中程度（日次損失-5%）
  - 最大取引数: 10件/日

**1ヶ月後**:
- 取引回数: 28回
- 勝率: 65%
- 月次リターン: +4.2%（84,000円）

---

## ⚠️ 重要な注意事項

### 投資リスク

- ✅ **余剰資金で運用**: 生活費には手をつけない
- ✅ **分散投資**: 1銘柄に集中しない
- ✅ **損切りルール**: 自動損切り（-5%）を設定済み
- ⚠️ **元本保証なし**: 損失の可能性あり

### システムリスク

- ✅ **定期確認**: 週1回はダッシュボードを確認
- ✅ **ログ確認**: `logs/auto_trader.log`でエラーチェック
- ✅ **バックアップ**: 定期的にDBをバックアップ
- ⚠️ **通信障害**: インターネット接続を維持

---

## 🆘 トラブルシューティング

### Q: LINEに通知が来ない

A: 以下を確認:
1. `config.json`の`line.enabled`が`true`
2. トークンが正しい
3. テスト実行: `python morning_brief.py`

### Q: 自動実行されない

A: タスクスケジューラを確認:
1. `Win + R` → `taskschd.msc`
2. 「AGStock Daily Scan」を右クリック → 「実行」
3. ログ確認: `logs/auto_trader.log`

### Q: エラーが出る

A: ログを確認:
```bash
type logs\auto_trader.log
```

よくあるエラー:
- **データ取得エラー**: インターネット接続を確認
- **モジュールエラー**: `pip install -r requirements.txt`
- **DB接続エラー**: `paper_trading.db`を削除して再起動

---

## 📞 サポート

質問・要望があれば:
1. GitHubでIssueを作成
2. ログファイルを添付
3. エラーメッセージをコピー

---

## 🎯 次のステップ

1. ✅ 通知設定完了
2. ✅ 自動実行設定完了
3. ⏳ 1週間様子を見る
4. ⏳ ダッシュボードで結果確認
5. ⏳ 必要に応じて設定調整

---

**🎉 これであなたも完全自動運用デビューです！**

仕事に専念しながら、AIが24時間市場を監視します。
