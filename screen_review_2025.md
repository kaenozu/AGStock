# AGStock アプリケーション 画面レビュー 2025

## 📊 概要

AGStockは、日本・米国・欧州の株式市場を対象とした、AIベースの自動取引システムです。Streamlitを使用したWebアプリケーションで、初心者でも使いやすいUI設計を目指しています。

このレビューでは、現在の画面構成を分析し、UI/UXの観点から改善提案を行います。

---

## ✅ 優れている点

### 1. **優れたビジュアルデザイン**
- ダークモードテーマを採用し、プロフェッショナルな印象
- カスタムCSS (`assets/style.css`) により、洗練されたデザインを実現
- グラデーションヘッダー、ホバーエフェクト、グラスモーフィズム効果が効果的
- Google Fonts (Inter, JetBrains Mono) の使用で、視認性が高い

### 2. **自動化機能の実装**
- `scan_results.json` キャッシュシステムにより、起動時に即座に推奨銘柄を表示
- `daily_scan.py` によるバックグラウンド処理で、UIをブロックせずスムーズな動作
- 「今日のイチオシ (Today's Best Pick)」セクションで、最も重要な情報を即座に表示

### 3. **初心者向けの配慮**
- 複雑な専門用語には説明文やヘルプテキストを添付
- リスクレベル表示（低/中/高）により、直感的にリスクを理解可能
- シグナルの「説明」により、AIの判断理由が明確

### 4. **豊富な機能セット**
- 6つのタブで機能を整理：ホーム、市場スキャン、ポートフォリオ、ペーパートレード、ダッシュボード、過去検証
- センチメント分析、AIロボアドバイザー、高配当戦略など、多面的な分析機能
- AI投資委員会機能による多様な視点での投資判断

---

## ⚠️ 改善が必要な点

### 1. **情報過多による認知負荷**

**問題点:**
- app.pyが1435行と巨大で、1つの画面に多数の機能が詰め込まれている
- 6つのタブすべてに大量の情報とUIコンポーネントが配置されている
- 初心者にとっては、どこから見始めればよいか分かりづらい

**改善案:**
```markdown
- **段階的な情報開示**: 初期表示は最小限にし、expanderやモーダルで詳細情報を隠す
- **ステップガイド**: 初回起動時にチュートリアルを表示
- **簡易モードと上級者モード**: ユーザーの習熟度に応じてUIを切り替え可能に
```

### 2. **ナビゲーションの改善必要**

**問題点:**
- タブが6つあり、情報の所在が分かりづらい
- 「ホーム」タブと「市場スキャン」タブの役割分担が不明確
- 「ダッシュボード」と「ホーム」の違いが初見では理解しづらい

**改善案:**
```markdown
- **タブ構成の見直し**:
  - ホーム: 概要ダッシュボード（当日の全体サマリー）
  - 分析: 市場スキャン + センチメント分析
  - 取引: ペーパートレード + 手動注文
  - ポートフォリオ: 保有資産 + パフォーマンス
  - 設定: 通知、リスク管理、ブローカー設定

- **ブレッドクラム**: 現在位置を示すナビゲーション要素を追加
- **クイックアクションバー**: よく使う機能へのショートカットボタンを画面上部に配置
```

### 3. **レスポンシブデザインの欠如**

**問題点:**
- モバイルデバイスでの表示が考慮されていない
- 多くの`st.columns()`が使用されているが、スマホでは横並びが見づらい
- チャートやテーブルが多く、小画面では操作が困難

**改善案:**
```markdown
- **モバイルファースト設計**: スマホでも主要機能が使えるよう、レイアウトを調整
- **アダプティブカラム**: デバイス幅に応じて自動的にカラム数を調整
- **スワイプ操作対応**: モバイルでタブ切り替えをスワイプで可能に（カスタムJS）
```

### 4. **パフォーマンスとローディング**

**問題点:**
- データ取得時のスピナーが多く、待ち時間が長い可能性
- `st.button()`で再スキャンするたびに全銘柄を処理するため、時間がかかる
- リアルタイム更新機能（60秒ごとの`st.rerun()`）がリソースを消費

**改善案:**
```markdown
- **スケルトンローディング**: スピナーの代わりに、プレースホルダーを表示
- **段階的ローディング**: 重要な情報から先に表示し、詳細データは非同期で取得
- **WebSocketベースの更新**: `st.rerun()`の代わりに、変更があった部分のみ更新
- **バックグラウンドWorker**: 重い計算をバックグラウンドで実行し、結果をキャッシュ
```

### 5. **一貫性のないデータ表示**

**問題点:**
- 通貨フォーマットが場所により異なる（`¥`, `円`, `JPY`）
- リスクレベル表示が絵文字（🟢🟡🔴）と色付きテキスト（`:green[低]`）の両方で混在
- 数値フォーマットの桁数や表記が統一されていない

**改善案:**
```markdown
- **デザインシステムの構築**:
  - `src/ui_components.py` を作成し、共通コンポーネントを定義
  - `format_currency()`, `format_percentage()`, `display_risk_badge()` などのユーティリティ関数
  - 色・フォント・サイズの定数を一元管理

- **スタイルガイド**: UIコンポーネントの使用ルールを文書化
```

### 6. **エラーハンドリングとフィードバック**

**問題点:**
- エラーメッセージが技術的すぎる（例: `キャッシュデータの読み込みに失敗しました: {e}`）
- 成功時のフィードバック（`st.balloons()`）は楽しいが、重要な情報が見逃される可能性
- try-exceptブロックで汎用的なエラーメッセージを表示している箇所が多い

**改善案:**
```markdown
- **ユーザーフレンドリーなメッセージ**:
  - 技術的な詳細はログに記録
  - ユーザーには「何が起きたか」「どうすればよいか」を明確に伝える
  - 例: "データの取得に失敗しました。インターネット接続を確認してください。"

- **インラインヘルプ**: エラー発生時に、関連するFAQやドキュメントへのリンクを表示
- **トースト通知の活用**: 非ブロッキングな通知で、作業を中断させない
```

### 7. **アクセシビリティの問題**

**問題点:**
- 色のみで情報を伝えている箇所が多い（色覚異常者への配慮不足）
- キーボードナビゲーションが困難
- 画面読み上げソフトへの対応が不明

**改善案:**
```markdown
- **WCAG準拠**:
  - カラーコントラスト比を4.5:1以上に
  - 色以外の視覚的手がかりを追加（アイコン、パターン）
  - Alt text、ARIA labelの追加

- **キーボードショートカット**: 主要機能にショートカットキーを割り当て
- **フォーカスインジケーター**: タブキーでのフォーカス移動を視覚的に分かりやすく
```

---

## 🎯 優先度別改善提案

### 🔴 高優先度（すぐに対応すべき）

1. **タブ構成の見直しとナビゲーション改善**
   - 現在6タブは多すぎる。3-4タブに統合し、階層構造を整理
   
2. **デザインシステムの構築**
   - UI/UXの一貫性を確保するため、共通コンポーネントライブラリを作成

3. **エラーハンドリングの改善**
   - ユーザー向けのエラーメッセージを分かりやすく

### 🟡 中優先度（次のイテレーションで対応）

4. **レスポンシブデザイン対応**
   - モバイルデバイスでの利用を考慮

5. **パフォーマンス最適化**
   - ローディング時間の短縮、段階的レンダリング

6. **初心者向けオンボーディング**
   - 初回起動時のチュートリアル、コンテキストヘルプ

### 🟢 低優先度（将来的に検討）

7. **アクセシビリティ対応**
   - WCAG準拠、キーボードナビゲーション強化

8. **国際化対応**
   - 英語版UI、多言語サポート

---

## 📋 具体的なUI改善案

### ホーム画面の簡略化

**現状:**
- `simple_dashboard.py`を呼び出しているが、内容が不明

**提案:**
```python
# ホーム画面の例
with tab_home:
    st.subheader("📈 本日のマーケットサマリー")
    
    # KPIメトリクス（3カラム）
    col1, col2, col3 = st.columns(3)
    with col1:
        st.metric("推奨シグナル", "5件", "+2")
    with col2:
        st.metric("ポートフォリオ評価額", "¥1,250,000", "+2.3%")
    with col3:
        st.metric("市場センチメント", "Positive", "↑")
    
    # 今日のイチオシ（大きく表示）
    st.markdown("---")
    st.subheader("🏆 今日のイチオシ")
    # [Best Pick カード]
    
    # クイックアクション
    st.markdown("---")
    col_a, col_b, col_c = st.columns(3)
    with col_a:
        if st.button("🔍 市場をスキャン", use_container_width=True):
            st.switch_page("pages/scan.py")
    with col_b:
        if st.button("💼 ポートフォリオ", use_container_width=True):
            st.switch_page("pages/portfolio.py")
    with col_c:
        if st.button("📝 注文する", use_container_width=True):
            st.switch_page("pages/trade.py")
```

### 市場スキャン画面の整理

**現状:**
- 1つのタブに、センチメント分析、スキャン結果、AIロボアドバイザー、高配当戦略、パターン検出がすべて詰め込まれている

**提案:**
```markdown
# 市場スキャン画面構成

## 上部セクション（常に表示）
- センチメントスコア（小さく、1行で）
- [市場をスキャン] ボタン

## 結果セクション（expanderで整理）
### 🏆 今日のイチオシ（常に展開）
- 最も期待値の高い1銘柄

### ✨ 推奨シグナル（常に展開）
- カード形式で2-5件表示

### 💰 AIロボアドバイザー（初期は折りたたみ）
- ポートフォリオ配分提案

### 📈 高配当・積立（初期は折りたたみ）
- 配当利回りの高い銘柄リスト

### 🔍 チャートパターン（初期は折りたたみ）
- テクニカルパターン検出結果

### 📊 詳細データ（上級者向け、初期は折りたたみ）
- 全データテーブル
```

---

## 🎨 ビジュアル改善提案

### カラーパレットの統一

**現在の課題:**
- グラデーション、色付きテキスト、絵文字が混在
- ダークモードでの視認性が場所により異なる

**提案:**
```css
/* デザイントークン */
:root {
  /* Primary Colors */
  --primary-blue: #2563eb;
  --primary-cyan: #00d4ff;
  --primary-green: #00ff9d;
  
  /* Semantic Colors */
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --info: #3b82f6;
  
  /* Risk Levels */
  --risk-low: #10b981;
  --risk-medium: #f59e0b;
  --risk-high: #ef4444;
  
  /* Backgrounds */
  --bg-primary: #0e1117;
  --bg-card: rgba(31, 41, 55, 0.6);
  --bg-hover: rgba(255, 255, 255, 0.05);
}
```

### タイポグラフィの階層化

```css
/* 見出しのサイズ統一 */
h1 { font-size: 2.5rem; }  /* ページタイトル */
h2 { font-size: 2rem; }    /* セクション見出し */
h3 { font-size: 1.5rem; }  /* サブセクション */

/* 本文 */
body { font-size: 1rem; line-height: 1.6; }

/* キャプション */
.caption { font-size: 0.875rem; color: #9ca3af; }
```

---

## 📱 レスポンシブレイアウト例

```python
# デバイス幅に応じてカラム数を調整
import streamlit as st

# セッションステートでデバイスタイプを管理
if 'device_type' not in st.session_state:
    st.session_state.device_type = 'desktop'  # デフォルト

# レスポンシブカラム
def responsive_columns(mobile_cols, tablet_cols, desktop_cols):
    device = st.session_state.device_type
    if device == 'mobile':
        return st.columns(mobile_cols)
    elif device == 'tablet':
        return st.columns(tablet_cols)
    else:
        return st.columns(desktop_cols)

# 使用例
cols = responsive_columns(mobile_cols=1, tablet_cols=2, desktop_cols=3)
```

---

## 🚀 実装ロードマップ

### フェーズ1: クリーンアップ（1-2週間）
- [ ] `app.py` を分割（ページごとに独立ファイル化）
- [ ] 共通UIコンポーネントライブラリの作成
- [ ] デザインシステムの定義と文書化

### フェーズ2: ナビゲーション改善（1週間）
- [ ] タブ構成の見直し（6タブ → 4タブ）
- [ ] ブレッドクラムの追加
- [ ] クイックアクションバーの実装

### フェーズ3: UX向上（2週間）
- [ ] 初心者向けオンボーディング
- [ ] エラーメッセージの改善
- [ ] ローディングパフォーマンス最適化

### フェーズ4: モバイル対応（2週間）
- [ ] レスポンシブデザインの実装
- [ ] タッチ操作の最適化
- [ ] モバイル専用UIの追加

---

## 💡 その他の提案

### 1. ダークモード/ライトモードの切り替え
```python
# サイドバーにテーマ切り替えトグルを追加
theme = st.sidebar.radio("テーマ", ["ダーク", "ライト"], horizontal=True)
if theme == "ライト":
    st.markdown(f"<style>{light_mode_css}</style>", unsafe_allow_html=True)
```

### 2. お気に入り機能
```python
# ユーザーが気になる銘柄をウォッチリストに追加
if 'watchlist' not in st.session_state:
    st.session_state.watchlist = []

if st.button("⭐ ウォッチリストに追加"):
    st.session_state.watchlist.append(ticker)
```

### 3. 通知センター
```python
# アプリ内通知を一元管理
with st.sidebar.expander("🔔 通知"):
    for notification in st.session_state.notifications:
        st.info(notification['message'])
```

---

## 📊 総合評価

| 項目 | 評価 | コメント |
|------|------|----------|
| **デザイン** | ⭐⭐⭐⭐☆ | ダークモード、カスタムCSSで洗練された見た目 |
| **使いやすさ** | ⭐⭐⭐☆☆ | 機能過多で初心者には複雑。整理が必要 |
| **パフォーマンス** | ⭐⭐⭐☆☆ | キャッシュは良いが、ローディングが多い |
| **機能性** | ⭐⭐⭐⭐⭐ | 非常に豊富。プロ仕様の分析機能を搭載 |
| **レスポンシブ** | ⭐⭐☆☆☆ | モバイル対応が不十分 |
| **アクセシビリティ** | ⭐⭐☆☆☆ | 色覚異常者への配慮が不足 |
| **総合** | ⭐⭐⭐★☆ | **3.5/5** - 優れた機能だが、UI/UXの洗練が必要 |

---

## 🎯 まとめ

AGStockアプリケーションは、**機能面では非常に優れた**自動取引システムです。AI分析、センチメント分析、ロボアドバイザーなど、プロレベルの機能を搭載しています。

しかし、**UI/UXの面では改善の余地**があります。特に以下の3点が重要です:

1. **情報の整理**: 機能過多で初心者が迷子になる。段階的な情報開示と明確なナビゲーションが必要
2. **一貫性**: デザイン、用語、データ表示の統一により、プロフェッショナルな印象を強化
3. **レスポンシブ対応**: モバイルデバイスでの利用を考慮した設計

これらの改善により、**初心者でも使いやすく、上級者も満足できる**理想的なUIを実現できます。

---

**レビュー作成日**: 2025-11-25  
**レビュアー**: Antigravity AI  
**対象バージョン**: app.py (1435行, 73KB)
