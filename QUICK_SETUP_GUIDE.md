# 🚀 AGStock 自動実行セットアップガイド（5分で完了）

このガイドに従って、完全自動運用を開始しましょう！

---

## ステップ1: LINE通知の設定（2分）

### 1-1. LINE Notifyのトークンを取得

1. ブラウザで以下のURLを開く:
   ```
   https://notify-bot.line.me/
   ```

2. LINEアカウントでログイン

3. 右上の自分の名前をクリック → **「マイページ」**

4. **「トークンを発行する」** をクリック

5. 以下を入力:
   - トークン名: `AGStock`
   - 送信先: `1:1でLINE Notifyから通知を受け取る`

6. **「発行する」** をクリック

7. 表示されたトークンを **コピー**
   ```
   ⚠️ このトークンは1回しか表示されません！
   必ずコピーしてください
   ```

### 1-2. config.jsonに設定

1. `c:\gemini-thinkpad\AGStock\config.json` を開く

2. 以下の部分を編集:
   ```json
   {
       "notifications": {
           "line": {
               "enabled": true,           ← false を true に変更
               "token": "ここに貼り付け"    ← コピーしたトークンを貼り付け
           }
       }
   }
   ```

3. 保存して閉じる

### 1-3. テスト送信

コマンドプロンプトまたはPowerShellで実行:

```bash
cd c:\gemini-thinkpad\AGStock
python morning_brief.py
```

**LINEに市況レポートが届けば成功！** ✅

届かない場合:
- トークンが正しく貼り付けられているか確認
- `"enabled": true` になっているか確認

---

## ステップ2: Windowsタスクスケジューラの設定（3分）

### 2-1. 管理者として実行

1. **PowerShell** を **管理者として実行**:
   - スタートメニューで「PowerShell」を検索
   - 右クリック → **「管理者として実行」**

2. 以下を実行:
   ```powershell
   cd c:\gemini-thinkpad\AGStock
   .\setup_automation.bat
   ```

### 2-2. セットアップ実行

スクリプトが以下を表示します:

```
================================================
AGStock 自動実行セットアップ
================================================

タスクスケジューラに以下のタスクを登録します:

1. AGStock Daily Scan
   - 実行時刻: 毎日 15:30 (市場終了後)
   - 処理内容: 市場スキャン、シグナル検出、自動取引

2. AGStock Morning Brief
   - 実行時刻: 毎日 08:00 (市場開始前)
   - 処理内容: 朝の市況レポート送信

セットアップを続行しますか？ (Y/N):
```

3. **Y** を入力してEnter

4. 完了メッセージが表示されたら成功！

```
================================================
セットアップ完了！
================================================

🎉 これで毎日自動で取引が実行されます！
   - 15:30: 市場スキャン・自動取引
   - 08:00: 朝の市況レポート
```

---

## ステップ3: 動作確認（即時）

### 3-1. タスクスケジューラを開く

1. `Win + R` を押す
2. `taskschd.msc` と入力してEnter

### 3-2. タスクが登録されているか確認

左側のツリーで:
**「タスクスケジューラライブラリ」** をクリック

以下の2つが表示されていればOK:
- ✅ **AGStock Daily Scan**
- ✅ **AGStock Morning Brief**

### 3-3. 手動でテスト実行

タスクを右クリック → **「実行する」**

数秒後にLINEに通知が届けば完璧！ 🎉

---

## ⚙️ 設定のカスタマイズ（オプション）

### 通知フィルタの調整

`config.json` で通知の条件を変更できます:

```json
{
    "notifications": {
        "min_confidence": 0.7,        // 信頼度70%以上のみ通知
        "min_expected_return": 0.03,  // 期待リターン3%以上のみ
        "quiet_hours": "22:00-07:00"  // 夜間は通知OFF
    }
}
```

### リスク管理の調整

```json
{
    "risk_guard": {
        "daily_loss_limit_pct": -5.0,   // 日次損失上限（-5%）
        "max_position_size_pct": 10.0,  // 1銘柄の最大比率（10%）
        "max_vix": 40.0                 // VIX上限
    },
    "safety": {
        "require_manual_approval": false,  // 自動承認（trueで手動承認）
        "max_daily_trades": 10             // 1日の最大取引数
    }
}
```

---

## 📱 日々の使い方

### 完全おまかせモード

**やることはこれだけ:**

1. **朝8:00**
   - LINEで市況レポートを確認
   - 今日の戦略をチェック

2. **夕方15:30**
   - 自動でスキャン・取引実行
   - シグナルがあればLINE通知

3. **夜**
   - アプリの「🏠 ホーム」タブで結果確認
   - 資産推移とリスクメーターをチェック

### アプリで確認

```bash
streamlit run app.py
```

- 🏠 **ホーム**: 資産状況・リスクメーター
- 📊 **市場スキャン**: 今日のシグナル
- 📝 **ペーパートレード**: 取引履歴

---

## 🔧 トラブルシューティング

### Q: タスクが実行されない

**A:** 以下を確認:

1. PCの電源が入っているか
2. タスクスケジューラで次回実行時刻を確認
3. ログファイルを確認:
   ```
   type logs\auto_trader.log
   type logs\morning_brief.log
   ```

### Q: LINEに通知が来ない

**A:** 以下を確認:

1. `config.json`の`"enabled": true`
2. トークンが正しいか
3. 手動でテスト:
   ```bash
   python morning_brief.py
   ```

### Q: エラーが出る

**A:** ログを確認:

```bash
type logs\auto_trader.log
```

よくあるエラー:
- **ModuleNotFoundError**: `pip install -r requirements.txt`
- **データ取得エラー**: インターネット接続を確認
- **DB接続エラー**: `paper_trading.db`を削除して再起動

---

## ✅ チェックリスト

セットアップ完了の確認:

- [ ] LINE Notifyトークン取得
- [ ] config.jsonに設定
- [ ] テスト送信成功（`python morning_brief.py`）
- [ ] タスクスケジューラ登録
- [ ] タスクが表示されている
- [ ] 手動実行でLINE通知確認

**全てチェック済みなら完了です！** 🎉

---

## 🎯 次のステップ

1. ✅ 自動実行設定 ← **完了！**
2. ⏳ 1週間様子を見る
3. ⏳ 設定を微調整（必要に応じて）
4. ⏳ 本番運用検討（お好みで）

---

**🎉 これで完全自動運用の開始です！**

仕事に専念しながら、AIが24時間市場を監視します。

何か困ったことがあれば `PERSONAL_INVESTOR_GUIDE.md` を参照してください。
